;; -*- Mode: Emacs-Lisp ; Coding: utf-8 -*-
(load "emacs-256color.el")
;;-----------------------------------------------------------------
;; eval-safe
;; http://www.sodan.org/~knagano/emacs/dotemacs.html#eval-safe
;;-----------------------------------------------------------------
(defmacro eval-safe (&rest body)
  "安全な評価。評価に失敗してもそこで止まらない。"
  `(condition-case err
       (progn ,@body)
     (error (message "[eval-safe] %s" err))))
;;-----------------------------------------------------------------
;; 初期位置
;;-----------------------------------------------------------------
(cd "~")
;;-----------------------------------------------------------------
;; スタートアップ時のメッセージを抑制
;;-----------------------------------------------------------------
(setq inhibit-startup-message t)
;;-----------------------------------------------------------------
;; emacs-serverを起動(emacsclientで使用)
;;-----------------------------------------------------------------
(eval-safe (server-start))
;;-----------------------------------------------------------------
;; エンコーディング
;;-----------------------------------------------------------------
(set-language-environment "Japanese")
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(set-buffer-file-coding-system 'utf-8)
(set-selection-coding-system 'utf-8)
(setq default-buffer-file-coding-system 'utf-8)
(setq default-file-name-coding-system 'utf-8)
(prefer-coding-system 'utf-8)
;;-----------------------------------------------------------------
;; バックアップしない
;;-----------------------------------------------------------------
(setq make-backup-files nil)
;;-----------------------------------------------------------------
;; 自動保存したファイルを削除する。
;;-----------------------------------------------------------------
(setq delete-auto-save-files t)
;;-----------------------------------------------------------------
;; 圧縮されたファイルも編集＆日本語infoの文字化け防止
;;-----------------------------------------------------------------
(auto-compression-mode t)
;;-----------------------------------------------------------------
;; 自動セーブしない。
;;-----------------------------------------------------------------
(setq auto-save-default nil)
(setq auto-save-list-file-prefix nil)   ; don't make ~/.saves-PID-hostname
;;-----------------------------------------------------------------
;; yes/noを、y/nで選択できるようにする。
;;-----------------------------------------------------------------
(fset 'yes-or-no-p 'y-or-n-p)
;;-----------------------------------------------------------------
;; kill-lineで行末の改行文字も削除
;;-----------------------------------------------------------------
(setq kill-whole-line t)
;;-----------------------------------------------------------------
;; デフォルトのモード
;;-----------------------------------------------------------------
(setq default-major-mode 'text-mode)
;;-----------------------------------------------------------------
;; メニューバー、ツールバー非表示
;;-----------------------------------------------------------------
(eval-safe (menu-bar-mode nil))
(eval-safe (tool-bar-mode nil))
;;-----------------------------------------------------------------
;; 行数、列数を表示
;;-----------------------------------------------------------------
(line-number-mode t)
(column-number-mode t)
;;-----------------------------------------------------------------
;; 時計を表示
;;-----------------------------------------------------------------
(setq display-time-day-and-date t
      display-time-24hr-format t)
(setq display-time-format "%m/%d(%a) %H:%M")
(display-time)
;;------------------------------------------------
;; シンタックスハイライトを有効にする
;;------------------------------------------------
(global-font-lock-mode t)
(if (>= emacs-major-version 21)
    (setq font-lock-support-mode 'jit-lock-mode)  ; Just-In-Timeな
					          ; 文字装飾方式
  (setq font-lock-support-mode 'lazy-lock-mode))  ;Emacs20以前では古い
					          ;方式
;;------------------------------------------------
;; 対応する括弧をハイライト表示
;;------------------------------------------------
(show-paren-mode t)
;;------------------------------------------------
;; リージョンをハイライト表示
;;------------------------------------------------
(setq transient-mark-mode t)
;;------------------------------------------------
;; 検索でマッチした箇所をハイライト表示
;;------------------------------------------------
(setq search-highlight t)
;;------------------------------------------------
;; 対話置換でマッチした箇所をハイライト
;;------------------------------------------------
(setq query-replace-highlight t)
;;-----------------------------------------------------------------
;; 記号やその他の文字等を正しくマッピングする
;; Emacs辞典p.395
;; http://www.pqrs.org/~tekezo/emacs/doc/wide-character/index.html
;;-----------------------------------------------------------------
(utf-translate-cjk-set-unicode-range
'((#x00a2 . #x00a3)
  (#x00a7 . #x00a8)
  (#x00ac . #x00ac)
  (#x00b0 . #x00b1)
  (#x00b4 . #x00b4)
  (#x00b6 . #x00b6)
  (#x00d7 . #x00d7)
  (#X00f7 . #x00f7)
  (#x0370 . #x03ff)
  (#x0400 . #x04FF)
  (#x2000 . #x206F)
  (#x2100 . #x214F)
  (#x2190 . #x21FF)
  (#x2200 . #x22FF)
  (#x2300 . #x23FF)
  (#x2500 . #x257F)
  (#x25A0 . #x25FF)
  (#x2600 . #x26FF)
  (#x2e80 . #xd7a3)
  (#xff00 . #xffef)))

